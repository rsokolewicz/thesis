(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      5891,        169]
NotebookOptionsPosition[      5433,        152]
NotebookOutlinePosition[      5810,        168]
CellTagsIndexPosition[      5767,        165]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"matsubaraexpr", " ", "=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", ",", "range", ",", "\[Lambda]p", ",", "residues"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"range", " ", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Mu]", "-", 
            RowBox[{"15", "/", "\[Beta]"}]}], ",", 
           RowBox[{"\[Mu]", "+", 
            RowBox[{"15", "/", "\[Beta]"}]}]}], "}"}]}], ";", "\n", "\t", 
        RowBox[{"tmp", " ", "=", " ", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Beta]", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[Beta]", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "-", "\[Mu]"}], ")"}]}], "]"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Exp", "[", 
               RowBox[{"\[Beta]", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", "-", "\[Mu]"}], ")"}]}], "]"}]}], 
             ")"}], "2"]], 
          FractionBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Pi]", "2"], " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", 
             SuperscriptBox["\[Epsilon]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["\[Epsilon]", "2"]}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Lambda]", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"\[Epsilon]", "-", "\[Lambda]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Lambda]", "+", "\[Epsilon]"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Pi]", "2"], " ", 
               SuperscriptBox["\[Alpha]", "2"], " ", 
               SuperscriptBox["\[Epsilon]", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}]]}]}], ";", "\n", 
        "\t", 
        RowBox[{"residues", " ", "=", " ", 
         RowBox[{"residues", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\[Mu]", "+", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "n"}], "+", "1"}], ")"}]}], "\[Beta]"]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", "100"}], "}"}]}], "]"}], "]"}]}]}], 
        ";", "\n", "\t", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
           RowBox[{"Residue", "[", 
            RowBox[{"tmp", ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", "\[Epsilon]p"}], "}"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]p", ",", "residues"}], "}"}]}], "]"}]}]}], "\n",
       "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", "myexpr2", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"myexpr2", " ", "[", 
     RowBox[{
     "\[Mu]p_", ",", "\[Beta]p_", ",", "\[Lambda]p_", ",", "\[Alpha]p_"}], 
     "]"}], ":=", 
    RowBox[{"matsubaraexpr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]", "\[Rule]", "\[Mu]p"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", "\[Beta]p"}], ",", 
       RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]p"}], ",", 
       RowBox[{"\[Alpha]", "\[Rule]", "\[Alpha]p"}]}], "}"}]}]}], "\n", "\n", 
   
   RowBox[{
    RowBox[{"myexpr2", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "//", 
    "N"}]}]}]], "Input",
 CellChangeTimes->{
  3.545825155715281*^9, {3.789999324233698*^9, 3.789999385969005*^9}, {
   3.7900000236903133`*^9, 3.790000080634335*^9}, {3.790000432760703*^9, 
   3.7900004338611803`*^9}},ExpressionUUID->"97adf9c6-1a07-4cf1-8073-\
5e405ac609c6"],

Cell[BoxData[
 FormBox[
  RowBox[{"0.0069283722700502984`", "\[VeryThinSpace]", "+", 
   RowBox[{"0.0018951316449810213`", " ", "\[ImaginaryI]"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.545825155716502*^9, {3.789999342873768*^9, 3.7899993513513527`*^9}, 
   3.79000003482239*^9, {3.790000073575471*^9, 3.790000081584478*^9}, 
   3.7900004631301947`*^9},ExpressionUUID->"ed96114d-16ae-421a-a4da-\
be854e8d68f0"]
}, Open  ]]
},
WindowSize->{1920, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"pastelSolarized.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4405, 116, 485, "Input",ExpressionUUID->"97adf9c6-1a07-4cf1-8073-5e405ac609c6"],
Cell[4988, 140, 429, 9, 83, "Output",ExpressionUUID->"ed96114d-16ae-421a-a4da-be854e8d68f0"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

